{"nickname":"21207516","exercises":{"tp1_ex1_expr":{"grade":100,"solution":"(* Renvoie 17, type int*)\n(3 * 5) + 2;;\n\n(* Renvoie 14, type int*)\n((fun x -> 2 * x) 7);;\n\n(* Renvoie 30, type int*)\n((fun x -> 2 * x) (3 * 5));;\n\n(* Renvoie 21, type int*)\n(((fun x -> (fun y -> x * y)) 3) 7);;\n\n(* Renvoie 21, type int*)\n((fun x -> fun y -> x * y) 3 7);;\n\n(* Renvoie 5, type int*)\n(fun f -> fun x -> (f x) + x) (fun x -> x - 1) 3;;\n\n(* Renvoie 3, type int*)\nlet (x, y) = (1, 2) in x + y;;\n\n(* Renvoie 3, type int*)\nlet a = (1, 2) in\nlet (x, y) = a in x + y;;\n\n(* Renvoie (f x = x + 1, 3), type (int -> int) * int*)\nlet f x = x + 1 in (f, 3);;\n\n(*\nif b then (fun x -> x) else 0 ;;\nNe compile pas, 0 est de type int alors que fun x->x est de type int->int\n*)\n(* Renvoie f x = x, type (int -> int)*)\nlet b = true in if b then (fun x -> x) else (fun x -> 0) ;;\n\n(* Renvoie 6, type int*)\nlet b = true in ((if b then (fun x -> x + 1) else (fun x -> x - 1)) 5);;\n\n(* Renvoie 1è, type int*)\n((fun b ->((fun x -> fun y -> 2 * x + 3 * y) (if b then 1 else 2) 5)) true);;\n\n(* Renvoie true, type int*)\nlet f = fun x -> not x in\nlet g = fun f -> fun x -> fun y -> (f (not x)) && (f y) in\n(g f true false);;\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1}]}],"mtime":1719922172.898209},"tp1_ex2_nuplets":{"grade":100,"solution":"\n(* Q1 *)\nlet fst (x, y) = x ;;\n  \n\nlet snd (x, y) = y ;;\n\n\n\n\n\n(* Q2 *)\n\nlet paire x y = (x, y) ;;\n\nlet paire_true x = (true, x) ;; \n\nlet curry (f : 'a * 'b -> 'c)  =  fun (x :'a) (y :'b) -> (f (paire x y)) ;; \n\nlet uncurry (g : 'a -> 'b -> 'c) : (('a * 'b) -> 'c) = fun ((x, y) : ('a * 'b)) ->\n  g x y ;;\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"fst","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"snd","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"paire","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"paire_true","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(curry (function | (x, y) -> x + y))","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"5"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(uncurry (fun x -> fun y -> x + y))","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1719926818.259456},"tp1_ex3_table":{"grade":100,"solution":"(* Q1 *)\n\nlet et_bool (a:bool) (b:bool) : bool =\n  match (a, b) with \n  |  (true, true) -> true  \n  |  (_, false) -> false \n  |  (false, _) ->false ;;\n      \n\n\nlet ou_bool (a:bool) (b:bool) : bool =\n  match (a, b) with \n  | (true, _) -> true \n  | (_, true) -> true \n  | (_, _) -> false ;;\n\n\nlet non_bool (a:bool) : bool =\n  if a then false else true ;;\n\n\n(* Q2 *)\n\nlet impl_bool (a:bool) (b:bool) : bool =\n  ou_bool (non_bool a) b ;;\n\nlet equiv (a:bool) (b:bool) : bool =\n  et_bool (impl_bool a b) (impl_bool b a) ;;\n\n\n\n(* Q3 *)\nlet xor (a:bool) (b:bool) : bool =\n  et_bool (ou_bool a b) (non_bool (et_bool a b))\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"et_bool","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"ou_bool","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"non_bool","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"impl_bool","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"equiv","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"xor","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1719927316.823513},"tp1_ex4_manip_fonctions":{"grade":100,"solution":"(* Q1 *)\nlet application (f : ('a -> 'b)) (x : 'a) = \n  f x ;;\n\n\n\n(* Q2 *)\nlet composition (f : ('b -> 'c)) (g : ('a -> 'b)) (x : 'a) : 'c =\n  f (g x) ;;  \n\n\n\n(* Q3 *)\nlet f_ou_ident (f : ('a -> 'a)) (mode : bool) (x:'a) : 'a = \n  if mode then x else f x ; \n\n\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"application","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"composition","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"f_ou_ident","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1719927446.928311},"tp1_ex5_manip_fonctions_2":{"grade":100,"solution":"\n(* Q2 *)\n\n(* fonction injective : identité *) \n(* fonction non injective : false *) \n\nlet est_injective (f : (bool -> bool)) : bool = \n  f true != f false ;;\n\n\n(* Q3 *)\n\nlet est_commutative (f : (bool -> bool -> bool)) : bool =\n  f true false = f false true ;;\n\n\n\n(* Q4 *)\n\nlet est_reciproque (f : (bool -> bool)) (g : (bool -> bool)) : bool =\n  f (g true) && (not ( f (g false)))  ;;\n\n\n\n(* Q5 *)\n\nlet reciproque (f : (bool -> bool)) : (bool -> bool) = \n  fun b : bool -> f b ;;\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(fun f -> ((f true) <> (f false)) = (est_injective f))","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(fun f -> ((f true false) = (f false true)) = (est_commutative f))","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"est_reciproque","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"5"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(let f = not in fun x -> ((reciproque f) (f x)) = x)","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"(let f y = y in fun x -> ((reciproque f) (f x)) = x)","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1719928323.164706},"tp1_ex6_addition_binaire":{"grade":100,"solution":"(* Q.2 *)\n\nlet xor (a : bit) (b : bit) : bit =\n  (a || b) && (not (a && b)) ;;\n\n(* Q.3 *)\n\nlet rec half_adder (a : bit) (b : bit) : (bit * bit) =\n  (xor a b, a && b) ;;\n\n(* Q.4 *)\n\nlet adder (a : bit) (b : bit) (c : bit) : (bit * bit) =\n  match (half_adder a b) with \n  | (s1, r1) -> \n      (\n        match (half_adder c s1) with \n        | (s2, r2) -> \n            (s2, r1 || r2)\n      ) ;;\n\n(* Q.6 *)\n(*\nlet duet_adder (a : duet) (b : duet) (c : bit) : (duet * bit) = \n  match (adder (fst a) (fst b) c) with \n  | (s1, r1) ->\n      match (adder (snd a) (snd b) r1) with \n      | (s2, r2) ->\n          (half_adder s2 r2, s1) ;;\n\n*)\n\nlet duet_adder (a : duet) (b : duet) (c : bit) : (duet * bit) = \n  let (a1, a2) = a in \n  let (b1, b2) = b in \n  let (s2, r2) = adder a2 b2 c in \n  let (s1, r1) = adder a1 b1 r2 in \n  (s1, s2), r1 ;;\n          \n\n(* Q.7 *)\n\n\nlet quartet_adder (a : quartet) (b : quartet) (c : bit) : (quartet * bit) =\n  match a with \n  | (x1, x2, x3, x4) ->\n      match b with \n      | (y1, y2, y3, y4) ->\n          match duet_adder (x3, x4) (y3, y4) c with \n          | (b1, r1) ->\n              match duet_adder (x1, x2) (y1, y2) r1 with \n              | (b2, r2) -> \n                  ((fst b2, snd b2, fst b1, snd b1), r2) ;;\n\nquartet_adder (false, false, false, true) (true, true, true, true) false \n\n(* Q.8 *)\n\nlet to_quartet (i : int) : quartet =\n  ( (i/8) mod 2 = 1, (i/4) mod 2 = 1, (i/2) mod 2 = 1, i mod 2 =1) ; \n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"xor","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"half_adder","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"adder","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"quartet_adder","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1719933820.658521},"tp2_ex1_factorielle":{"grade":100,"solution":"\nlet rec fact (n:int) : int = \n  match n with \n  | 0 -> 1 \n  | _ -> n * fact (n-1) ;;\n\n\nlet fact2 (n:int) : int =\n  let rec aux n a = \n    match n with \n    | 0 -> a \n    | _ -> aux (n-1) (a * n) \n  in aux n 1 ;;\n\n\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"fact","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"fact2","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720017887.052333},"tp2_ex2_sommes":{"grade":100,"solution":"(* Q1 *)\nlet rec sum_n (n:int) : int =\n  match n with \n  | 0 -> 0 \n  | _ -> n + sum_n (n-1) ;;\n\n(* Q2 *)\nlet sum_n2 (n:int) : int =\n  let rec sumT n = match n with \n    | 0 -> 0 \n    | _ -> if n < 0 then raise (Invalid_argument \"sum_n\") else n + sumT (n-1)\n  in sumT n ;;\n      \n\n(* Q3 *)\nlet rec sum_p (n:int) : int =\n  match n with \n  | 0 -> 0 \n  | _ -> sum_p(n-1) + (2*n) ;;\n\n(* Q4 *)\nlet rec sum_f (f : int -> int) (n:int) : int =\n  match n with \n  | 0 -> f 0 \n  | _ -> f n + sum_f f (n-1) ;;\n\nlet sum_p2 (n:int) : int =\n  let f n = 2 * n \n  in sum_f f n ;;\n  \n  \n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_n","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_n2","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_p","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"(fun (k, n) -> sum_f (fun i -> (k * i) + 1) n)","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_p2","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720006859.873619},"tp2_ex3_suite":{"grade":100,"solution":"(* Q1 *)\nlet rec u (n:int) : int = match n with \n  | 0 -> 42 \n  | _ -> 3 * u (n-1) + 4 ;;\n\n(* Q2 *)\nlet rec sum_u (n:int) : int = match n with \n  | 0 -> 42 \n  | _ -> u n + sum_u (n-1) ;;\n\n(* Q3 *)\nlet sum_u2 (n:int) : int =\n  let rec loop (n:int) (t:int) : int = match n with \n    | 0 -> t\n    | _ -> t + loop (n-1) (3 * t + 4  )\n  in loop n 42 ;;\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"u","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_u","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_u2","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720009022.896402},"tp2_ex4_intervalle":{"grade":100,"solution":"(* Q1 *)\n(* On suppose que a < b*)\nlet rec sum_inter (a:int) (b:int) : int = \n  if (a > b) then 0 else a + sum_inter (a + 1) b\n\n(* Q2 *)\nlet rec sum1_inter (k:int) (a:int) (b:int) : int =\n  if (a > b) then 0 else a + k + sum1_inter k (a+1) b\n\n(* Q3 *)\nlet rec sum2_inter (a:int) (b:int) : int = \n  if (a > b) then 0 else ((2 * (sum1_inter a a b)) - (2 * a)) + sum2_inter (a+1) b ;;\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum_inter","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum1_inter","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sum2_inter","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720013376.163016},"tp2_ex4_premiers":{"grade":100,"solution":"(* Q1 *)\nlet rec less_divider (i:int) (n:int) : int = \n  if i = n then 0 else \n  if n mod i = 0 then i else less_divider (i+1) n\n\n(* Q2 *)\nlet prime (n : int) : bool = \n  if n <= 1 then false else \n    less_divider 2 n = 0 ;;\n\n(* Q3 *)\nlet rec next_prime (n : int) : int = \n  if prime n then n else next_prime (n+1) ;;\n\n(* Q4  *)\nlet nth_prime (n : int) : int = \n  let rec aux n k = \n    if n = 0 then k else aux (n-1) (next_prime (k + 1)) \n  in\n  aux n 2 ;;\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"less_divider","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"prime","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"next_prime","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"nth_prime","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720012329.248645},"tp2_ex5_polynome":{"grade":100,"solution":"(* Q1 *)\nlet float_of_3int (t:int * int * int) : (float *float *float) = \n  match t with \n  | (i1, i2, i3) -> (float_of_int i1, float_of_int i2, float_of_int i3) ;;\n\n(* Q2 *)\nlet valeur_poly ((a,b,c):(int*int*int)) (f : float) : float =\n  match float_of_3int (a, b, c) with \n  | (f1, f2, f3) -> (f1*.f*.f) +. (f2*.f) +. f3 ;;\n\n(* Q3 *)\nlet discriminant ((a,b,c):(int*int*int)) : int =\n  b * b - (4 * a * c) ;;\n\n(* Q4 *)\nlet nb_solution (d: int) : int =\n  match d with \n  | 0 -> 1 \n  | _ -> if d > 0 then 2 else 0 ;;\n\n(* Q5 *)\n\n\nlet solutions ((a,b,c):(int*int*int)) : (float * float) =\n  let d = discriminant (a, b, -c) in \n  if nb_solution d = 0 then (0.0, 0.0) else\n    let bt = -.(float_of_int b) \n    and at = (float_of_int  (2 * a)) \n    and dt = (sqrt (float_of_int d)) \n    in if nb_solution d = 1 then\n      let s = bt /. at in \n      (s, s) \n    else ((bt +. dt) /. at , (bt -. dt) /. at) ;;","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"float_of_3int","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"valeur_poly","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"discriminant","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"nb_solution","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"5"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"solutions","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720013433.700762},"tp2_ex6_rec":{"grade":100,"solution":"(* Q1 *)\nlet rec p (n:int) : float = \n  match n with \n  | 1 -> 1. \n  | _ -> 1. /. (float_of_int (n*n)) +. p (n-1) ;;\n    \n\n\nlet f n = sqrt (6. *. p n) ;;\n\n(* Stack overflow *) \n\n(* Q2 *)\nlet p' (n:int) : float = \n  let rec aux (n : int) (s : float) : float = \n    match n with \n    | 1 -> 1. +. s \n    | _ -> aux (n-1) (s +. (1. /. ((float_of_int n) *. (float_of_int n))))\n  in aux n 0. ;;\n\n\n\nlet f' n = sqrt (6. *. p' n)\n\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"p","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"p'","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720013074.444179},"tp2_ex7_square_root":{"grade":100,"solution":"\n\n(* Q1 *)\nlet f (a:float) (x:float) : float =\n  1. /. 2. *. ( x +. a /. x);;\n\n\n\n(* Q2 *)\nlet rec sqrt_n (n:int) (a:float) (x:float) =\n  if n > 0 then sqrt_n (n-1) a (f a x) else x ;;\n\n\n\n(* Q3 *)\nlet eq_eps (e:float) (x:float) (y:float) : bool =\n  let d = abs_float (x -. y)\n  in d <= e ;;\n  \n\n\n(* Q4 *)\nlet rec sqrt_x (e:float) (a:float) (r:float) : float =\n  if eq_eps e r (f a r) then (f a r) else sqrt_x e a (f a r) ;; \n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"f","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sqrt_n","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"eq_eps","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"sqrt_x","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720014731.661033},"tp2_ex8_halt":{"grade":100,"solution":"\n(* Q1 *)\n\nlet rec fib n =\n  if n <= 1 then 1 else fib (n-1) + fib (n-2) ;;\n\n\n(* Q2 *)\n\nlet fib2 n =\n  let rec aux n a2 a1 = \n    if n <= 2 then a2 + a1 else aux (n -1) a1 (a2 + a1)\n  in if n <= 1 then 1 else aux n 1 1 ;;\n    \n\n\n(* Q3 *)\n\nlet rec f91 n =\n  if n > 100 \n  then \n    (n - 10) \n  else\n    f91 (f91(n+11)) \n;;\n       \n\n\n(* Q4 *)\n\nlet rec even n = \n  if (n = 0) \n  then \n    true \n  else \n    odd (n-1) \nand odd n = \n  if (n = 0)\n  then\n    false\n  else\n    even (n-1)\n;;\n\n\n(* Q5 *)\n\nlet rec syracuse n = \n  match n with \n  | 1 -> 1 \n  | _ -> \n      if (even n) \n      then \n        syracuse(n/2)\n      else \n        syracuse((3 * n) + 1) \n;;\n        \n\n\n(* Q6 *)\n\nlet rec ack m n = \n  match m, n with \n  | 0, 0 -> 1\n  | _, 0 -> ack (m-1) 1\n  | 0, _ -> n + 1 \n  | _, _ -> ack (m-1) (ack m (n-1))\n;;\n\n\n","report":[{"section":[{"text":"Q"},{"text":"1"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"fib","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"2"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"fib2","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"3"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"f91","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"4"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"odd","display":"output"},{"text":" semble correcte."}],"result":"informative"},{"message":[{"text":"L'expression suivante :"},{},{"text":"even","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"5"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"syracuse","display":"output"},{"text":" semble correcte."}],"result":"informative"}]},{"section":[{"text":"Q"},{"text":"6"}],"contents":[{"message":[],"result":1},{"message":[{"text":"L'expression suivante :"},{},{"text":"ack","display":"output"},{"text":" semble correcte."}],"result":"informative"}]}],"mtime":1720017585.38345}},"exercise-toplevel-histories":{"tp1_ex1_expr":{"phrases":["let b = true in if b then (fun x -> x) else (fun x -> 0) ;;","let b = true in ((if b then (fun x -> x + 1) else (fun x -> x - 1)) 5);;","((fun b ->((fun x -> fun y -> 2 * x + 3 * y) (if b then 1 else 2) 5)) true);;","let f = fun x -> not x in\nlet g = fun f -> fun x -> fun y -> (f (not x)) && (f y) in\n(g f true false);;"],"mtime":1719920639.368}}}